(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-08a62328"],{9082:function(e,t,i){"use strict";i.r(t);var r=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-card",{staticClass:"box-card card-main",attrs:{shadow:"never"}},[i("div",{attrs:{slot:"header"},slot:"header"},[i("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:e.serchRole,"label-width":"90px","label-position":"right",size:"mini"}},[i("el-form-item",{attrs:{label:"用户名："}},[i("el-input",{attrs:{placeholder:"请输入用户名"},model:{value:e.serchRole.name,callback:function(t){e.$set(e.serchRole,"name",t)},expression:"serchRole.name"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"用户描述："}},[i("el-input",{attrs:{placeholder:"请输入用户描述"},model:{value:e.serchRole.description,callback:function(t){e.$set(e.serchRole,"description",t)},expression:"serchRole.description"}})],1),e._v(" "),i("el-form-item",[i("el-button",{attrs:{type:"primary"},on:{click:e.searchList}},[e._v("查询")]),e._v(" "),i("el-button",{on:{click:e.resetSearch}},[e._v("重置")])],1)],1)],1),e._v(" "),i("el-row",[i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.handleAddOrEdit()}}},[e._v("添加角色")])],1),e._v(" "),i("el-table",{staticStyle:{width:"auto"},attrs:{data:e.roleList,border:"",stripe:"",size:"small"}},[i("el-table-column",{attrs:{type:"selection",align:"center",width:"35"}}),e._v(" "),i("el-table-column",{attrs:{prop:"name",align:"center",label:"角色名称"}}),e._v(" "),i("el-table-column",{attrs:{prop:"description",align:"center",label:"角色描述"}}),e._v(" "),i("el-table-column",{attrs:{width:"150",align:"center",label:"创建时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.createTime))]}}])}),e._v(" "),i("el-table-column",{attrs:{fixed:"right",label:"操作",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-button",{staticStyle:{padding:"3px 4px 3px 4px",margin:"1px"},attrs:{size:"mini"},on:{click:function(i){return e.handleAddOrEdit(t.row)}}},[e._v("查看/编辑权限")]),e._v(" "),"admin"!==t.row.username?i("el-button",{staticStyle:{padding:"3px 4px 3px 4px",margin:"1px"},attrs:{type:"danger",size:"mini"},on:{click:function(i){return e.deleteRow(t.row)}}},[e._v("删除")]):e._e()]}}])})],1),e._v(" "),i("el-pagination",{attrs:{background:"","current-page":e.pageInfo.pageNum,"page-sizes":[10,20,30,50],"page-size":e.pageInfo.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.pageInfo.pageCount},on:{"size-change":e.changePageSize,"current-change":e.changePageNum}}),e._v(" "),i("el-dialog",{attrs:{"close-on-click-modal":!1,title:e.addOrEditForm.title,visible:e.addOrEditFormVisible,width:"500px"},on:{"update:visible":function(t){e.addOrEditFormVisible=t},close:function(t){return e.closeDialog("addOrEditForm")}}},[i("el-form",{ref:"addOrEditForm",attrs:{"label-width":"90px",model:e.addOrEditForm,size:"small",rules:e.roleRules}},[i("el-form-item",{attrs:{label:"角色名称",prop:"name"}},[i("el-input",{attrs:{"auto-complete":"off",placeholder:"请输入角色名称"},model:{value:e.addOrEditForm.name,callback:function(t){e.$set(e.addOrEditForm,"name",t)},expression:"addOrEditForm.name"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"角色描述",prop:"description"}},[i("el-input",{attrs:{"auto-complete":"off",placeholder:"请输入角色描述"},model:{value:e.addOrEditForm.description,callback:function(t){e.$set(e.addOrEditForm,"description",t)},expression:"addOrEditForm.description"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"权限配置"}},[i("el-tree",{ref:"listTree",attrs:{data:e.allPermissions,props:e.listTreeProps,"node-key":"id","show-checkbox":!0,accordion:!0,"empty-text":"没有权限数据"}})],1)],1),e._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{size:"small"},on:{click:function(t){return e.closeDialog("addOrEditForm")}}},[e._v("取消")]),e._v(" "),i("el-button",{staticClass:"title",attrs:{size:"small",type:"primary"},on:{click:function(t){return e.submitForm("addOrEditForm")}}},[e._v("保存")])],1)],1)],1)},s=[],n=(i("cc57"),i("cc5e")),o=i("c24f"),a=i("3fa5"),l={name:"Role",data:function(){return{serchRole:{name:"",description:""},pageInfo:{pageNum:1,pageSize:10,pageCount:0},listTreeProps:{label:"name",children:"children"},allPermissions:[],roleList:[],addOrEditFormVisible:!1,addOrEditForm:{title:"",id:"",name:"",description:"",permissionIds:[]},roleRules:{name:[{required:!0,message:"角色名称不能为空",trigger:"blur"},{pattern:/^[0-9A-Za-z]{3,10}$/,message:"角色名称由3-10位数或字字母组合",trigger:"blur"}],description:[{required:!0,message:"角色描述不能为空",trigger:"blur"}]}}},computed:{serchInfo:function(){var e=this.pageInfo;return e.serchRole=this.serchRole,e}},mounted:function(){var e=this;this.getUserPageList(),Object(o["f"])().then((function(t){e.allPermissions=t}))},methods:{handleAddOrEdit:function(e){var t=this;e?(this.addOrEditFormVisible=!0,this.addOrEditForm.title="编辑角色",this.addOrEditForm.id=e.id,this.addOrEditForm.name=e.name,this.addOrEditForm.description=e.description,Object(n["d"])({roleId:e.id}).then((function(e){e=e||[],t.$nextTick((function(){t.$refs.listTree.setCheckedKeys(e)}))}))):(this.addOrEditFormVisible=!0,this.addOrEditForm.title="新增角色")},deleteRow:function(e){var t=this;this.$confirm("此操作将永久删除该角色, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(n["c"])(e.id).then((function(e){t.$message({type:"success",message:"删除成功!"}),t.getUserPageList()}))})).catch((function(){t.$message({type:"success",message:"已取消删除"})}))},resetSearch:function(){this.serchRole={}},searchList:function(){this.getUserPageList()},changePageSize:function(e){this.pageInfo.pageSize=e,this.requestUsersInfo()},changePageNum:function(e){this.pageInfo.pageNum=e,this.requestUsersInfo()},getUserPageList:function(){var e=this;Object(n["b"])(this.serchInfo).then((function(t){e.roleList=t.list||{},e.pageInfo.pageCount=t.total}))},submitForm:function(e){var t=this;this.$refs[e].validate((function(i){i&&"addOrEditForm"===e&&(t.addOrEditForm.permissionIds=t.$refs.listTree.getCheckedKeys().concat(t.$refs.listTree.getHalfCheckedKeys()),Object(n["e"])(t.addOrEditForm).then((function(i){t.addOrEditFormVisible=!1,t.getUserPageList(),t.$refs[e].resetFields(),Object(a["a"])("保存数据成功")})))}))},closeDialog:function(e){"addOrEditForm"===e&&(this.addOrEditFormVisible=!1,this.$refs.listTree.setCheckedKeys([]),this.$refs[e].resetFields())}}},d=l,c=i("5511"),u=Object(c["a"])(d,r,s,!1,null,"2cf99413",null);t["default"]=u.exports},cc5e:function(e,t,i){"use strict";i.d(t,"a",(function(){return s})),i.d(t,"b",(function(){return n})),i.d(t,"d",(function(){return o})),i.d(t,"e",(function(){return a})),i.d(t,"c",(function(){return l}));var r=i("b775"),s=function(e){return Object(r["d"])("/roles/all",e)},n=function(e){return Object(r["d"])("/roles/allByPage",e)},o=function(e){return Object(r["d"])("/permissions/childListID",e)},a=function(e){return Object(r["e"])("/roles",e)},l=function(e){return Object(r["b"])("/roles/"+e)}}}]);