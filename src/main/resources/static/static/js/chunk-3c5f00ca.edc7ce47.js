(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3c5f00ca"],{"018c":function(e,t,a){"use strict";var n=a("a0fb"),l=a.n(n);l.a},"664d":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"my-border"},[a("el-card",{staticClass:"box-card card-main ",attrs:{shadow:"never"}},[a("el-row",{staticClass:"header"},[a("b",{staticClass:"title"},[e._v(e._s(e.title))]),e._v(" "),a("el-button",{staticStyle:{"margin-left":"25px"},attrs:{size:"mini",type:"primary"},on:{click:e.save}},[e._v("保存")])],1),e._v(" "),a("el-card",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"box-card api-detail-card",attrs:{shadow:"never"}},[a("el-form",{ref:"addOrEditForm",attrs:{model:e.dataInfo,"label-position":"right",rules:e.rules,size:"mini"}},[a("el-form-item",{attrs:{label:"环境名称：","label-width":"82px",prop:"name"}},[a("el-input",{staticStyle:{width:"400px"},attrs:{placeholder:"请输入环境名称"},model:{value:e.dataInfo.name,callback:function(t){e.$set(e.dataInfo,"name",t)},expression:"dataInfo.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"环境域名：","label-width":"82px",prop:"domain"}},[a("el-input",{staticStyle:{width:"400px"},attrs:{placeholder:"请输入内容"},model:{value:e.dataInfo.domain,callback:function(t){e.$set(e.dataInfo,"domain",t)},expression:"dataInfo.domain"}},[a("el-select",{staticStyle:{width:"90px"},attrs:{slot:"prepend",placeholder:"请选择"},slot:"prepend",model:{value:e.dataInfo.prepend,callback:function(t){e.$set(e.dataInfo,"prepend",t)},expression:"dataInfo.prepend"}},[a("el-option",{attrs:{label:"http://",value:"http://"}}),e._v(" "),a("el-option",{attrs:{label:"https://",value:"https://"}})],1)],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"备注：","label-width":"82px"}},[a("el-input",{staticStyle:{width:"400px"},attrs:{type:"textarea",autosize:{minRows:1,maxRows:5}},model:{value:e.dataInfo.remark,callback:function(t){e.$set(e.dataInfo,"remark",t)},expression:"dataInfo.remark"}})],1),e._v(" "),a("el-divider",{attrs:{"content-position":"left"}},[e._v("环境变量")])],1),e._v(" "),a("el-table",{staticClass:"el-table-no-border",attrs:{data:e.dataInfo.global,size:"mini","show-header":!1}},[a("el-table-column",{attrs:{property:"key",label:"Key","header-align":"center","min-width":"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{attrs:{size:"mini",placeholder:"key"},model:{value:t.row.key,callback:function(a){e.$set(t.row,"key",a)},expression:"scope.row.key"}})]}}])}),e._v(" "),a("el-table-column",{attrs:{property:"value",label:"Value","header-align":"center","min-width":"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{attrs:{size:"mini",placeholder:"value"},model:{value:t.row.value,callback:function(a){e.$set(t.row,"value",a)},expression:"scope.row.value"}})]}}])}),e._v(" "),a("el-table-column",{attrs:{property:"remark",label:"Value","header-align":"center","min-width":"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{attrs:{size:"mini",placeholder:"remark"},model:{value:t.row.remark,callback:function(a){e.$set(t.row,"remark",a)},expression:"scope.row.remark"}})]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作","header-align":"center",width:"40"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.$index+1!==e.global.length?a("el-button",{staticStyle:{padding:"5px 0px 5px"},attrs:{type:"text",icon:"el-icon-delete"},nativeOn:{click:function(a){return e.delTableRow("global",t.$index)}}}):e._e()]}}])})],1)],1)],1)],1)},l=[],i=a("b48a"),o=a("3fa5"),r={data:function(){return{visible:!1,loading:!1,title:"",apiEvnId:"",dataInfo:{},global:[],rules:{name:[{required:!0,message:"环境名称不能为空",trigger:"blur"}],domain:[{required:!0,message:"环境域名不能为空",trigger:"blur"}]}}},watch:{"dataInfo.global":{handler:function(e){0===this.dataInfo.global.length?this.addTableRow("global"):this.dataInfo.global[this.dataInfo.global.length-1]["key"]&&this.addTableRow("global");for(var t=0;t<this.dataInfo.global.length;t++){var a=this.dataInfo.global[t];if(t!==this.dataInfo.global.length-1&&!a.key&&!a.value){this.delTableRow("global",t);break}}},deep:!0}},mounted:function(){},methods:{init:function(e){this.$refs["addOrEditForm"].resetFields(),e?(this.title="编辑环境",this.apiEvnId=e,this.getApiEvn()):(this.title="新增环境",this.apiEvnId="",this.dataInfo={},this.dataInfo.prepend="http://",this.dataInfo.projectId=this.$store.getters.projectId)},addTableRow:function(e){"global"===e&&this.dataInfo.global.push({key:"",value:"",remark:""})},delTableRow:function(e,t){"global"===e&&this.dataInfo.global.splice(t,1)},save:function(){var e=this;this.$refs["addOrEditForm"].validate((function(t){if(t){var a=JSON.parse(JSON.stringify(e.dataInfo));a.global&&a.global.length>0&&a.global.splice(a.global.length-1,1),e.apiEvnId?Object(i["e"])(a).then((function(t){e.$emit("refreshData",t),Object(o["a"])("保存数据成功")})):Object(i["a"])(a).then((function(t){e.$emit("refreshData",t),Object(o["a"])("保存数据成功")}))}}))},getApiEvn:function(){var e=this;this.loading=!0,Object(i["c"])(this.apiEvnId).then((function(t){"http://"===t.prepend&&"https://"===t.prepend||(t.prepend="http://"),e.dataInfo=t||{},e.loading=!1}))}}},s=r,d=(a("018c"),a("5511")),c=Object(d["a"])(s,n,l,!1,null,"e95dede4",null);t["default"]=c.exports},a0fb:function(e,t,a){},b48a:function(e,t,a){"use strict";a.d(t,"d",(function(){return l})),a.d(t,"c",(function(){return i})),a.d(t,"a",(function(){return o})),a.d(t,"e",(function(){return r})),a.d(t,"b",(function(){return s}));var n=a("b775"),l=function(e){return Object(n["d"])("/apiEnv/listByProject/"+e)},i=function(e){return Object(n["d"])("/apiEnv/"+e)},o=function(e){return Object(n["e"])("/apiEnv/add",e)},r=function(e){return Object(n["f"])("/apiEnv/edit",e)},s=function(e){return Object(n["e"])("/apiEnv/remove",e)}}}]);