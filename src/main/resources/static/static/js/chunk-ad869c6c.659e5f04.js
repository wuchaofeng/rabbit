(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-ad869c6c"],{"629f":function(e,t,n){"use strict";n.r(t);var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("el-row",[n("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){e.dialogVisible=!0}}},[e._v("导入新数据")])],1),e._v(" "),n("el-table",{staticStyle:{width:"auto"},attrs:{data:e.dataList,border:"",stripe:"",size:"small"}},[n("el-table-column",{attrs:{align:"center",label:"文件名称"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.name))]}}])}),e._v(" "),n("el-table-column",{attrs:{width:"320",align:"center",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(n){return e.downloadCsv(t.row.name)}}},[e._v("下载")]),e._v(" "),n("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(n){return e.openCoverCsvDialog(t.row.name)}}},[e._v("覆盖")]),e._v(" "),n("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(n){return e.deleteRow(t.row)}}},[e._v("删除")])]}}])})],1),e._v(" "),n("el-dialog",{attrs:{title:"导入数据","close-on-click-modal":!1,visible:e.dialogVisible,width:"410px",center:""},on:{"update:visible":function(t){e.dialogVisible=t}}},[n("el-upload",{directives:[{name:"loading",rawName:"v-loading",value:e.uploadLoading,expression:"uploadLoading"}],ref:"upload",attrs:{"show-file-list":!1,drag:"","http-request":e.uploadCsv,action:"#",multiple:""}},[n("i",{staticClass:"el-icon-upload"}),e._v(" "),n("div",{staticClass:"el-upload__text"},[e._v("将文件拖到此处，或"),n("em",[e._v("点击上传")])]),e._v(" "),n("div",{staticClass:"el-upload__tip",attrs:{slot:"tip",center:""},slot:"tip"},[e._v("只能上cvs传文件，且不超过10M")])])],1),e._v(" "),n("el-dialog",{attrs:{title:"覆盖数据","close-on-click-modal":!1,visible:e.dialogVisible1,width:"410px",center:""},on:{"update:visible":function(t){e.dialogVisible1=t}}},[n("el-upload",{directives:[{name:"loading",rawName:"v-loading",value:e.uploadLoading1,expression:"uploadLoading1"}],ref:"upload1",attrs:{"show-file-list":!1,drag:"","http-request":e.coverCsv,action:"#",multiple:""}},[n("i",{staticClass:"el-icon-upload"}),e._v(" "),n("div",{staticClass:"el-upload__text"},[e._v("将文件拖到此处，或"),n("em",[e._v("点击上传")])]),e._v(" "),n("div",{staticClass:"el-upload__tip",attrs:{slot:"tip",center:""},slot:"tip"},[e._v("只能上cvs传文件，且不超过10M")])])],1)],1)},a=[],r=(n("63ff"),n("e71e")),s=(n("7364"),n("7bc1"),n("c0eb")),o={props:["value","scriptInfo"],data:function(){return{coverCsvName:"",dialogVisible:!1,dialogVisible1:!1,uploadLoading:!1,uploadLoading1:!1,dataList:[]}},watch:{value:{handler:function(e){var t="";e&&(t=e.split(",")),this.dataList=[];for(var n=0;n<t.length;n++){var i=t[n];i&&this.dataList.push({name:i})}},immediate:!0},dataList:function(e){for(var t="",n=0;n<e.length;n++){var i=e[n];t=t+i.name+","}this.$emit("input",t)}},mounted:function(){},methods:{openCoverCsvDialog:function(e){this.coverCsvName=e,this.dialogVisible1=!0},flushCsvData:function(){var e=this;Object(s["e"])(this.$route.query.id).then(function(t){var n=t.dataPath||"",i="";n&&(i=n.split(",")),e.dataList=[];for(var a=0;a<i.length;a++){var r=i[a];r&&e.dataList.push({name:r})}})},addRow:function(e){},deleteRow:function(e){var t=this;this.$confirm("此操作将永久删除该文件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var n={scriptId:t.scriptInfo.id,csvName:e.name};Object(s["b"])(n).then(function(e){t.$message({type:"success",message:"删除成功!"}),t.flushCsvData()})}).catch(function(){t.$message({type:"success",message:"已取消删除"})})},uploadCsv:function(e){var t=this,n=e.file,i=n.size<10485760,a=n.name.lastIndexOf("."),o=n.name.substr(a+1);if("csv"!==o.toLowerCase())return this.$message.warning("只能上传csv文件"),!1;if(!i)return this.$message.warning("请上传10M以下的csv文件"),!1;var c=new FormData;c.append("files",n),c.append("scriptId",this.scriptInfo.id),c.append("isCover",!1),this.uploadLoading=!0,Object(s["h"])(c).then(function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(n){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if("存在同名csv文件"!==n){e.next=5;break}return e.next=3,t.$confirm("该csv文件名称已存在, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){c.set("isCover",!0),Object(s["h"])(c).then(function(e){t.$message({type:"success",message:"上传成功!"}),t.flushCsvData()})}).catch(function(){});case 3:e.next=7;break;case 5:t.$message({type:"success",message:"上传成功!"}),t.flushCsvData();case 7:t.dialogVisible=!1,t.$refs["upload"].clearFiles();case 9:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()).finally(function(){t.uploadLoading=!1})},coverCsv:function(e){var t=this,n=e.file,i=n.size<10485760,a=n.name.lastIndexOf("."),o=n.name.substr(a+1);if("csv"!==o.toLowerCase())return this.$message.warning("只能上传csv文件"),!1;if(!i)return this.$message.warning("请上传10M以下的csv文件"),!1;var c=new FormData;c.append("files",n),c.append("scriptId",this.scriptInfo.id),c.append("orgCsvName",this.coverCsvName),this.uploadLoading1=!0,Object(s["f"])(c).then(function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(n){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:t.$message({type:"success",message:"上传成功!"}),t.flushCsvData(),t.dialogVisible1=!1,t.$refs["upload1"].clearFiles();case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()).finally(function(){t.uploadLoading1=!1})},downloadCsv:function(e){var t=this,n={projectId:this.scriptInfo.projectId,scriptName:this.scriptInfo.scriptPath,fileName:e};Object(s["g"])(n).then(function(t){var n=t.data;if(n){var i=new Blob([n]);if(window.navigator.msSaveOrOpenBlob)navigator.msSaveBlob(i,e);else{var a=window.URL.createObjectURL(i),r=document.createElement("a");r.style.display="none",r.href=a,r.setAttribute("download",e),document.body.appendChild(r),r.click(),document.body.removeChild(r),window.URL.revokeObjectURL(a)}}}).catch(function(e){t.$message.error(e+"")})}}},c=o,l=n("6691"),u=Object(l["a"])(c,i,a,!1,null,"46a18681",null);t["default"]=u.exports},c0eb:function(e,t,n){"use strict";n.d(t,"d",function(){return a}),n.d(t,"e",function(){return r}),n.d(t,"a",function(){return s}),n.d(t,"j",function(){return o}),n.d(t,"c",function(){return c}),n.d(t,"b",function(){return l}),n.d(t,"i",function(){return u}),n.d(t,"h",function(){return d}),n.d(t,"f",function(){return p}),n.d(t,"g",function(){return f});var i=n("b775"),a=function(e){return Object(i["d"])("/jmeterScript/listPage",e,!1)},r=function(e){return Object(i["d"])("/jmeterScript/listById/"+e)},s=function(e){return Object(i["e"])("/jmeterScript/add",e)},o=function(e){return Object(i["f"])("/jmeterScript/edit",e)},c=function(e){return Object(i["e"])("/jmeterScript/remove",e)},l=function(e){return Object(i["d"])("/jmeterScript/removeCsv",e)},u=function(e){return Object(i["g"])("/jmeterScript/uploadScripts",e)},d=function(e){return Object(i["g"])("/jmeterScript/uploadCsv",e)},p=function(e){return Object(i["g"])("/jmeterScript/coverCsv",e)},f=function(e){return Object(i["c"])("/jmeterScript/downloadCsv",e)}}}]);