(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-ad869c6c"],{"629f":function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("el-row",[n("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(e){t.dialogVisible=!0}}},[t._v("导入新数据")])],1),t._v(" "),n("el-table",{staticStyle:{width:"auto"},attrs:{data:t.dataList,border:"",stripe:"",size:"small"}},[n("el-table-column",{attrs:{align:"center",label:"文件名称"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.name))]}}])}),t._v(" "),n("el-table-column",{attrs:{width:"320",align:"center",label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(n){return t.downloadCsv(e.row.name)}}},[t._v("下载")]),t._v(" "),n("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(n){return t.openCoverCsvDialog(e.row.name)}}},[t._v("覆盖")]),t._v(" "),n("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(n){return t.deleteRow(e.row)}}},[t._v("删除")])]}}])})],1),t._v(" "),n("el-dialog",{attrs:{title:"导入数据","close-on-click-modal":!1,visible:t.dialogVisible,width:"410px",center:""},on:{"update:visible":function(e){t.dialogVisible=e}}},[n("el-upload",{directives:[{name:"loading",rawName:"v-loading",value:t.uploadLoading,expression:"uploadLoading"}],ref:"upload",attrs:{"show-file-list":!1,drag:"","http-request":t.uploadCsv,action:"#",multiple:""}},[n("i",{staticClass:"el-icon-upload"}),t._v(" "),n("div",{staticClass:"el-upload__text"},[t._v("将文件拖到此处，或"),n("em",[t._v("点击上传")])]),t._v(" "),n("div",{staticClass:"el-upload__tip",attrs:{slot:"tip",center:""},slot:"tip"},[t._v("只能上cvs传文件，且不超过10M")])])],1),t._v(" "),n("el-dialog",{attrs:{title:"覆盖数据","close-on-click-modal":!1,visible:t.dialogVisible1,width:"410px",center:""},on:{"update:visible":function(e){t.dialogVisible1=e}}},[n("el-upload",{directives:[{name:"loading",rawName:"v-loading",value:t.uploadLoading1,expression:"uploadLoading1"}],ref:"upload1",attrs:{"show-file-list":!1,drag:"","http-request":t.coverCsv,action:"#",multiple:""}},[n("i",{staticClass:"el-icon-upload"}),t._v(" "),n("div",{staticClass:"el-upload__text"},[t._v("将文件拖到此处，或"),n("em",[t._v("点击上传")])]),t._v(" "),n("div",{staticClass:"el-upload__tip",attrs:{slot:"tip",center:""},slot:"tip"},[t._v("只能上cvs传文件，且不超过10M")])])],1)],1)},a=[],r=(n("63ff"),n("57f0")),s=(n("cc57"),n("9a33"),n("c0eb")),o={props:["value","scriptInfo"],data:function(){return{coverCsvName:"",dialogVisible:!1,dialogVisible1:!1,uploadLoading:!1,uploadLoading1:!1,dataList:[]}},watch:{value:{handler:function(t){var e="";t&&(e=t.split(",")),this.dataList=[];for(var n=0;n<e.length;n++){var i=e[n];i&&this.dataList.push({name:i})}},immediate:!0},dataList:function(t){for(var e="",n=0;n<t.length;n++){var i=t[n];e=e+i.name+","}this.$emit("input",e)}},mounted:function(){},methods:{openCoverCsvDialog:function(t){this.coverCsvName=t,this.dialogVisible1=!0},flushCsvData:function(){var t=this;Object(s["e"])(this.$route.query.id).then((function(e){var n=e.dataPath||"",i="";n&&(i=n.split(",")),t.dataList=[];for(var a=0;a<i.length;a++){var r=i[a];r&&t.dataList.push({name:r})}}))},addRow:function(t){},deleteRow:function(t){var e=this;this.$confirm("此操作将永久删除该文件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var n={scriptId:e.scriptInfo.id,csvName:t.name};Object(s["b"])(n).then((function(t){e.$message({type:"success",message:"删除成功!"}),e.flushCsvData()}))})).catch((function(){e.$message({type:"success",message:"已取消删除"})}))},uploadCsv:function(t){var e=this,n=t.file,i=n.size<10485760,a=n.name.lastIndexOf("."),o=n.name.substr(a+1);if("csv"!==o.toLowerCase())return this.$message.warning("只能上传csv文件"),!1;if(!i)return this.$message.warning("请上传10M以下的csv文件"),!1;var c=new FormData;c.append("files",n),c.append("scriptId",this.scriptInfo.id),c.append("isCover",!1),this.uploadLoading=!0,Object(s["h"])(c).then(function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(n){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if("存在同名csv文件"!==n){t.next=5;break}return t.next=3,e.$confirm("该csv文件名称已存在, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){c.set("isCover",!0),Object(s["h"])(c).then((function(t){e.$message({type:"success",message:"上传成功!"}),e.flushCsvData()}))})).catch((function(){}));case 3:t.next=7;break;case 5:e.$message({type:"success",message:"上传成功!"}),e.flushCsvData();case 7:e.dialogVisible=!1,e.$refs["upload"].clearFiles();case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).finally((function(){e.uploadLoading=!1}))},coverCsv:function(t){var e=this,n=t.file,i=n.size<10485760,a=n.name.lastIndexOf("."),o=n.name.substr(a+1);if("csv"!==o.toLowerCase())return this.$message.warning("只能上传csv文件"),!1;if(!i)return this.$message.warning("请上传10M以下的csv文件"),!1;var c=new FormData;c.append("files",n),c.append("scriptId",this.scriptInfo.id),c.append("orgCsvName",this.coverCsvName),this.uploadLoading1=!0,Object(s["f"])(c).then(function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(n){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.$message({type:"success",message:"上传成功!"}),e.flushCsvData(),e.dialogVisible1=!1,e.$refs["upload1"].clearFiles();case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).finally((function(){e.uploadLoading1=!1}))},downloadCsv:function(t){var e=this,n={projectId:this.scriptInfo.projectId,scriptName:this.scriptInfo.scriptPath,fileName:t};Object(s["g"])(n).then((function(e){var n=e.data;if(n){var i=new Blob([n]);if(window.navigator.msSaveOrOpenBlob)navigator.msSaveBlob(i,t);else{var a=window.URL.createObjectURL(i),r=document.createElement("a");r.style.display="none",r.href=a,r.setAttribute("download",t),document.body.appendChild(r),r.click(),document.body.removeChild(r),window.URL.revokeObjectURL(a)}}})).catch((function(t){e.$message.error(t+"")}))}}},c=o,l=n("5511"),u=Object(l["a"])(c,i,a,!1,null,"46a18681",null);e["default"]=u.exports},c0eb:function(t,e,n){"use strict";n.d(e,"d",(function(){return a})),n.d(e,"e",(function(){return r})),n.d(e,"a",(function(){return s})),n.d(e,"j",(function(){return o})),n.d(e,"c",(function(){return c})),n.d(e,"b",(function(){return l})),n.d(e,"i",(function(){return u})),n.d(e,"h",(function(){return d})),n.d(e,"f",(function(){return p})),n.d(e,"g",(function(){return f}));var i=n("b775"),a=function(t){return Object(i["d"])("/jmeterScript/listPage",t,!1)},r=function(t){return Object(i["d"])("/jmeterScript/listById/"+t)},s=function(t){return Object(i["e"])("/jmeterScript/add",t)},o=function(t){return Object(i["f"])("/jmeterScript/edit",t)},c=function(t){return Object(i["e"])("/jmeterScript/remove",t)},l=function(t){return Object(i["d"])("/jmeterScript/removeCsv",t)},u=function(t){return Object(i["g"])("/jmeterScript/uploadScripts",t)},d=function(t){return Object(i["g"])("/jmeterScript/uploadCsv",t)},p=function(t){return Object(i["g"])("/jmeterScript/coverCsv",t)},f=function(t){return Object(i["c"])("/jmeterScript/downloadCsv",t)}}}]);